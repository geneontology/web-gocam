<mat-card class="mat-elevation-z5">

  <mat-card-header>
    <mat-card-title>
      <h1 class="heading-primary">{{ dataSource?.filteredData.length }} available GO-CAMs</h1>
    </mat-card-title>
    <mat-card-subtitle>{{ utils.lastUpdate() }}</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>

    <div *ngIf="isLoading" style="text-align: center">
      Loading Models ... &nbsp;
      <mat-spinner color=accent [diameter]="20" style="display: inline-block; vertical-align:middle"></mat-spinner>
    </div>

    <div *ngIf="isBufferLoading" style="text-align: center; background-color: rgba(orange, 0.5)">
      Loading Buffers ... &nbsp;
      <mat-spinner color=primary [diameter]="20" style="display: inline-block; vertical-align:middle"></mat-spinner>
    </div>

    <!-- can not use the *ngIf directive with table !

    -->
    <div [hidden]="isLoading">

      <!-- FILTER SECTION -->
      <div style="margin-bottom:5rem;">
        <mat-form-field style="display:inline-block;width:50%;min-width:20%;">
          <input matInput (mouseover)="filterFocus()" (click)="filterFocus()" (keyup)="applyFilter($event.target.value)" placeholder="Filter"
            [(ngModel)]="searchFilter" style="margin:0;padding:0">
          <mat-hint>Title, Biological Process, Molecular Function, PMID, Curator, Group</mat-hint>
        </mat-form-field>
        <mat-paginator [pageSizeOptions]="pageSizes" (page)="changeTablePage($event)" style="display:inline-block; width:45%; margin:0;padding:0;position:absolute;right:2rem"></mat-paginator>
      </div>



      <!-- TABLE SECTION -->
      <mat-table [dataSource]="dataSource" matSort>

        <!-- Basic Header -->
        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>

        <mat-row *matRowDef="let row; columns: displayedColumns;" style="padding:3px;">
        </mat-row>

        <!-- DATE SECTON -->
        <ng-container matColumnDef="date">
          <mat-header-cell *matHeaderCellDef mat-sort-header>
            <h2 class="heading-secondary">Date</h2>
          </mat-header-cell>
          <mat-cell *matCellDef="let row">
            {{ row.date | date }}
          </mat-cell>
        </ng-container>


        <!-- TITLE SECTION -->
        <ng-container matColumnDef="title">
          <mat-header-cell *matHeaderCellDef mat-sort-header>
            <h2 class="heading-secondary">Title</h2>
          </mat-header-cell>
          <mat-cell *matCellDef="let row">
            <a href="{{ urlHandler.getPathwayView(row.gocam) }}" target="blank" class="row__title">{{row.title}} &nbsp;
              <br>
              <hr>
              <mat-icon>open_in_new</mat-icon>
            </a>

            <div class="row__articles__container">
              <span class="row__article" *ngFor="let source of row.pmid">
                <span matTooltip="{{ articleTooltip }}" matTooltipPosition="below" [matTooltipShowDelay]="0.2">
                  <a href="{{ urlHandler.getPubMedAbstract(source.pmid) }}" target="_blank" (mouseover)=overpmid(source.pmid)>
                    <mat-icon>library_books</mat-icon>
                  </a>
                </span>
              </span>
            </div>

          </mat-cell>
        </ng-container>



        <!-- BIOLOGICAL PROCESSES COLUMN -->
        <ng-container matColumnDef="bps">
          <mat-header-cell *matHeaderCellDef mat-sort-header class="mat-column-align-center">
            <h2 class="heading-secondary">Processes</h2>
          </mat-header-cell>
          <mat-cell *matCellDef="let row">
            <!--
          <mat-chip-list *ngIf="bps.get(row.gocam);" class="mat-chip-list-stacked">
            <span matTooltip="{{ bpToolTip(bp) }}" *ngFor="let bp of bps.get(row.gocam);" matTooltipPosition="before" [matTooltipShowDelay]="prefs.toolTipDelay">
              <mat-chip class="bp" selected="true" (click)="navigate(bp.id)" style="margin-bottom:calc(1px + 0.5vw); margin-top:calc(1px + 0.5vw);">
                {{ bp.name }}
              </mat-chip>
            </span>
          </mat-chip-list>
          -->
            <mat-chip-list *ngIf="row?.bp" class="mat-chip-list-stacked">
              <span matTooltip="{{ bp.definition}}" *ngFor="let bp of row.bp;" matTooltipPosition="before" [matTooltipShowDelay]="prefs.toolTipDelay">
                <mat-chip class="bp" selected="true" (click)="ols(bp.id)" style="margin-bottom:calc(1px + 0.5vw); margin-top:calc(1px + 0.5vw);">
                  {{ bp.name }}
                </mat-chip>
              </span>
            </mat-chip-list>
          </mat-cell>
        </ng-container>



        <!-- MOLECULAR FUNCTIONS COLUMN -->
        <ng-container matColumnDef="mfs">
          <mat-header-cell *matHeaderCellDef mat-sort-header class="mat-column-align-center">
            <h2 class="heading-secondary">Functions</h2>
          </mat-header-cell>
          <mat-cell *matCellDef="let row">

            <!--
          <mat-chip-list *ngIf="mfs.get(row.gocam);" class="mat-chip-list-stacked">
            <span matTooltip="{{ mfToolTip(mf) }}" *ngFor="let mf of mfs.get(row.gocam);" matTooltipPosition="after" [matTooltipShowDelay]="prefs.toolTipDelay">
              <mat-chip class="mf" selected="true" (click)="navigate(mf.id)" style="margin-bottom:calc(1px + 0.5vw); margin-top:calc(1px + 0.5vw);color:black">
                {{ mf.name }}
              </mat-chip>
            </span>
          </mat-chip-list>
          -->
            <mat-chip-list *ngIf="row?.mf" class="mat-chip-list-stacked">
              <span matTooltip="{{ mf.definition }}" *ngFor="let mf of row.mf;" matTooltipPosition="after" [matTooltipShowDelay]="prefs.toolTipDelay">
                <mat-chip class="mf" selected="true" (click)="ols(mf.id)" style="margin-bottom:calc(1px + 0.5vw); margin-top:calc(1px + 0.5vw);color:black">
                  {{ mf.name }}
                </mat-chip>
              </span>
            </mat-chip-list>
          </mat-cell>
        </ng-container>


        <!-- GENE PRODUCT COLUMN
      <ng-container matColumnDef="gps">
        <mat-header-cell *matHeaderCellDef mat-sort-header>Gene Products</mat-header-cell>
        <mat-cell *matCellDef="let row">
          <mat-chip-list *ngIf="row?.gp" class="mat-chip-list-stacked">
            <span matTooltip="Unknown" *ngFor="let gp of row.gp;" matTooltipPosition="before" [matTooltipShowDelay]="prefs.toolTipDelay">
              <mat-chip class="gp" selected="true" (click)="open(gp.id)" style="margin-bottom:calc(1px + 0.5vw); margin-top:calc(1px + 0.5vw);">
                {{ gp.name }}
              </mat-chip>
            </span>
          </mat-chip-list>
        </mat-cell>
      </ng-container>
       -->



        <!-- CONTRIBUTOR COLUMN -->
        <ng-container matColumnDef="contributors">
          <mat-header-cell *matHeaderCellDef mat-sort-header class="mat-column-align-right">
            <h2 class="heading-secondary">Curators</h2>
          </mat-header-cell>
          <mat-cell *matCellDef="let row" [style.color]="row.color" class="mat-column-align-right">
            <div *ngFor="let name of row.names; let i = index" [attr.data-index]="i">
              <a routerLink="/users/{{utils.extractORCID(row.orcids[i])}}" *ngIf="row.orcids[i].indexOf('GOC:') == -1">{{simplifyName(name)}}</a>
              <span *ngIf="row.orcids[i].indexOf('GOC:') != -1">{{name}}</span>
            </div>
          </mat-cell>
        </ng-container>



        <!-- GROUP COLUMN -->
        <ng-container matColumnDef="groups">
          <mat-header-cell *matHeaderCellDef mat-sort-header class="mat-column-align-right">
            <h2 class="heading-secondary">Groups</h2>
          </mat-header-cell>
          <mat-cell *matCellDef="let row" [style.color]="row.color" class="mat-column-align-right">
            <span *ngFor="let name of row.groupnames; let i = index" [attr.data-index]="i">
              <a routerLink="/groups/{{name}}" *ngIf="row.groupids[i]">{{name}}</a>
              <span *ngIf="!row.groupids[i]">{{name}}</span>
            </span>
          </mat-cell>
        </ng-container>



      </mat-table>
    </div>

  </mat-card-content>
</mat-card>